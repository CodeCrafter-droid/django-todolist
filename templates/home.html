{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TODO LIST - Home</title>

    <!-- Bootstrap -->
     <link rel="icon" type="image/x-icon" href="{% static 'favicon-bl-dk.ico' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <style>
        .form-control{
        padding: 1.375rem .75rem !important;
    }
    </style>
</head>
<body>
<!-- {% if messages %}
<div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1055;">
    {% for message in messages %}
        <div class="toast show bg-danger text-white">
            <div class="toast-body">
                {{ message }}
            </div>
        </div>
    {% endfor %}
</div>
{% endif %} -->
<nav class="navbar navbar-light bg-light px-3">
  <div class="container-fluid">

    <!-- Left -->
    <div class="col-4">
      <a class="navbar-brand fw-bold" href="#">TODO</a>
    </div>

    <!-- Center -->
    <div class="col-4 text-center">
      <span class="h3 mb-0">Django ToDo App</span>
    </div>
    {% if user.is_authenticated %}
    <div class="col-4 text-end">
        <a href="{% url 'logout'%}" class="btn btn-danger">
            Log out
        </a>
    {% else %}
    <div class="col-4 text-end">
        <a href="{% url 'signup_login' %}?tab=login" class="btn btn-outline-primary me-1">
            Login
        </a>
        <a href="{% url 'signup_login'%}?tab=signup" class="btn btn-primary">
            Sign Up
        </a>
    {% endif %}
    </div>
</nav>    
{% if user.is_authenticated %}
<div class="container">
        <div class="row">
            <h4>My Day</h4>
            <p class="text-muted">{% now "jS F Y" %}</p>
            <div class="col-md-7 col-lg-7" style="height: 450px; overflow: scroll;">
                <!-- List of all the tasks for the day -->
                {% for task in td %}
                {% if task.is_completed == False %}
                <div class="card m-1">
                    <div class="card-body">
                        {{ task.task }}
                        <span style="position: relative; float: right;">
                            <form action="{% url 'mark_done' task.id %}" style="display:inline;">
                                <button type="submit" class="btn btn-success btn-sm">
                                        <i class="fa fa-check"></i> Mark as Done
                                </button>
                            </form>
                            <form action="{% url 'delete_task' task.id %}" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this task?');">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-danger btn-sm">
                                    <i class="fa fa-trash"></i>
                                </button>
                            </form>
                            <form action="{% url 'edit_task' task.id %}" method="get" style="display:inline;">
                                <button type="submit" class="btn btn-primary btn-sm">
                                    <i class="fa fa-pencil"></i>
                                </button>
                           </form>
                        </span>
                    </div>
                </div>
               {% endif %}
               {% endfor %}
            </div>
            <div class="col-md-5 col-lg-5" style="height: 450px; overflow: scroll;">
                <h5>Completed Tasks</h5>
                <!-- List of all the tasks that have completed -->
                {% for task in td %}
                {% if task.is_completed  %}
                <div class="card m-1">
                    <div class="card-body">
                        {{task.task}}
                        <span style="position: relative; float: right;">
                          <form action="{% url 'undo_task' task.id %}" style="display:inline;">
                                <button type="submit" class="btn btn-warning btn-sm">
                                    <i class="fa fa-undo"></i> Undo
                                </button>
                          </form>
                            <form action="{% url 'delete_task' task.id %}" style="display:inline;">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-danger btn-sm">
                                    <i class="fa fa-trash"></i>
                                </button>
                            </form>
                        </span>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 col-lg-6 p-0 mt-2">
                <!-- To Do Form -->
                <form action="{% url 'addtask'%}" method="post" >
                    {% csrf_token %}
                    <div class="form-group">
                        <span style="display: flex;">
                            <input type="text" class="form-control" placeholder="Add a task" name="data" required>
                            <button class="btn btn-primary" style="width: 200px;"><i class="fa fa-plus"></i> Add</button>
                        </span>
                    </div>
                </form>
            </div>
        </div>
    </div>
    {% endif %}
{% if not td.user %}
<div class="d-flex justify-content-center align-items-center" style="height: calc(100vh - 56px);">
  <div class="text-center" style="max-width: 400px;">
    <h4>What you can do:</h4>
    <ul class="list-group mt-3">
      <li class="list-group-item"> 
        <a href="{% url 'signup_login' %}?tab=signup" class="text-decoration-none">
          ‚úÖ Add tasks
        </a>
      </li>
      <li class="list-group-item">
        <a href="{% url 'signup_login' %}?tab=login" class="text-decoration-none">
          üïí Mark Done
        </a>
      </li>
      <li class="list-group-item">
        <a href="{% url 'signup_login' %}?tab=login" class="text-decoration-none">
          ‚≠ê Mark as complete
        </a>
      </li>
    </ul>
  </div>
</div>
{% endif %}
</body>
</html>